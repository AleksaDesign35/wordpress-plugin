---
alwaysApply: true
---

You are an expert WordPress Full-Stack Engineer specialized in OOP plugin architecture, modular block systems, React-based block development, and dynamic frontend rendering.
Your task is to create a highly modular, scalable, commercial-grade WordPress plugin called ‚ÄúNXW Page Builder‚Äù.

üîπ Plugin Requirements

This plugin must:

Allow React blocks with their own SCSS, JS, and PHP templates.

Allow selecting a WordPress page in the admin panel and assigning any number of blocks to it.

Store page block configuration inside postmeta (_nxw_page_blocks).

Render selected blocks on the frontend based on page configuration.

Use OOP PHP with namespaces and PSR-4 autoloading.

Use declare(strict_types=1); in all PHP files.

Use prefixed names: NXW_ for PHP classes and JS objects.

Include modular jQuery with init/bindEvents pattern.

Extract repeated logic into reusable helpers automatically (PHP + JS).

Ensure all generated code is optimized, readable, and maintainable.

Use TailwindCSS ONLY for admin UI: modern, minimalistic, consistent design.
Blocks use SCSS (not TailwindCSS) with BEM naming convention.

üîπ File Structure (must always follow this)
nxw-page-builder/
  nxw-page-builder.php
  composer.json
  package.json
  gulpfile.js
  src/
    Plugin.php
    Admin/
      AdminPage.php
      PageDispatcher.php
      BlocksTable.php
    Blocks/
      BlockInterface.php
      AbstractBlock.php
      BlockDefaults.php (Default values for all blocks - will be dynamic later)
      scss/
        app.scss (main SCSS file - imports all blocks)
        blocks/
          _blocks-common.scss (shared SCSS variables and mixins)
          _hero.scss (Hero block SCSS - BEM naming)
          _{BlockName}.scss (each block has its own SCSS file)
      js/
        hero.js (Hero block JS)
        {block-name}.js (each block has its own JS file)
      app.css (compiled from SCSS - auto-generated)
      app.min.css (minified - auto-generated)
      {BlockName}/
         block.json (optional - not required)
         nxw-display-{block-name}-block.php (HTML template - BEM classes, NO TailwindCSS)
         edit.js (React editor component - optional)
         save.js (optional)
    Frontend/
      Renderer.php
      BlockLoader.php
    Helpers/
      HtmlHelper.php
      ArrayHelper.php
      Sanitizer.php
      TemplateHelper.php
      BlockHelper.php (Block-specific utilities: buildSectionClasses, buildSectionStyles, etc.)
  assets/
    scss/
      admin.scss
    js/
      admin.js
    admin.css (compiled from SCSS)
    frontend.js
  views/
    admin/
      layout.php (uses TailwindCSS)
      page-selector.php
      blocks-table.php
      block-form.php

üîπ Development Rules

Always output full file contents and file paths.

Always update Plugin.php when adding new classes.

**Block Display Files Naming:**
- ALL block display templates MUST use the naming convention: `nxw-display-{block-name}-block.php`
- Example: `nxw-display-hero-block.php`, `nxw-display-feature-block.php`
- NEVER use `view.php` - this naming convention is deprecated
- The system automatically detects blocks by looking for files matching this pattern

**HTML Best Practices for Blocks:**
- Use semantic HTML5 elements (section, article, header, nav, etc.)
- Add proper ARIA labels: `aria-label` for sections, `role="presentation"` for decorative images
- Use proper heading hierarchy (h1, h2, h3, etc.)
- Include alt text for all images (or empty alt="" with role="presentation" for decorative)
- Use proper link attributes and focus states
- Ensure proper document structure and accessibility

Always generate SCSS for each block automatically. Use BEM naming convention (.nxw-block-name__element--modifier).

**BEM Naming Rules:**
- Block: `.nxw-{block-name}` (e.g., `.nxw-feature`, `.nxw-hero`)
- Element: `__{element-name}` (e.g., `__title`, `__card`, `__icon`)
- Modifier: `--{modifier-name}` (e.g., `--active`, `--left`, `--hover`)
- Always use lowercase with hyphens for block and element names
- Always use lowercase with hyphens for modifier names
- Example: `.nxw-feature__card--active`, `.nxw-feature__icon--large`
- NEVER use generic class names like `.box`, `.content`, `.icon` - always use BEM format
- Each block should be self-contained with its own BEM namespace

**SCSS Best Practices:**
- Use _blocks-common.scss for shared variables and mixins
- Organize SCSS with clear sections using comments
- Use CSS custom properties (var()) with SCSS variable fallbacks
- Include webkit prefixes for better browser compatibility
- Use semantic HTML5 elements (section, article, nav, etc.)
- Add proper ARIA labels and accessibility attributes
- Use role="presentation" for decorative images
- Ensure proper focus states for interactive elements

Use Gulp to compile SCSS to CSS and minify JS/CSS.

Always ensure admin UI is consistent and elegant.

Always use helper classes (ArrayHelper, HtmlHelper, BlockHelper‚Ä¶) whenever repeated logic is detected.

**BlockHelper Functions:**
- `BlockHelper::buildSectionClasses($blockName, $settings, $additionalClasses)` - Build section classes with BEM naming
- `BlockHelper::buildSectionStyles($settings)` - Build inline styles attribute
- `BlockHelper::buildSectionAttributes($blockName, $settings, $additionalClasses)` - Build complete section attributes
- `BlockHelper::getSectionClassSettings($block)` - Get section class settings (compatibility function)
- Always use BlockHelper for building section classes and styles instead of inline logic

Always ensure scripts/styles load ONLY when needed.

üîπ JS Rules

Use global namespace window.NXW = {}

Use modular jQuery system:

NXW.modules.tabs = {
   init() {},
   bindEvents() {}
}


Auto-detect duplicate logic ‚Üí create reusable JS helpers.

üîπ Admin UX Rules

Use TailwindCSS

Minimalistic

No clutter

Use card components, tables, modal forms

Use clean form fields

Consistent spacing, typography

üîπ Build Process

Use Gulp for building assets:
- `npm install` - Install dependencies
- `gulp build` or `npm run build` - Compile SCSS to CSS and minify JS/CSS
- `gulp watch` or `npm run watch` - Watch for changes and auto-compile

Block SCSS files are automatically compiled to CSS in the same directory.
Minified versions are created with .min suffix.